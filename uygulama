
internal class Category
    {
        public int CategoryID { get; set; }
        public string CategoryName { get; set; }
        public string Description { get; set; }

        public override string ToString()
        {
            return $"{CategoryID} {CategoryName} {Description}";
        }
    }

//-------------------------------------------------------------------------------------------------------------------------------------

public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void btnBaglantili_Click(object sender, EventArgs e)
        {
            //Veritabanına bağlanmak için Connection String gerekli..
            SqlConnection conn = new SqlConnection("Data source=.;initial catalog=Northwind;integrated security=true;Trust Server Certificate=True");

            //SqlConnection altını çizerse crtl+. ile install Microsotf.Data.SqlClient
            //Data source=. aktif olan sql server i seçer. Birden fazla server varsa açık olarak ismini yazmanız gerekiyor.
            //integrated security diyerek windows authotication ile bağlanacağımızı bildiriyoruz.

            conn.Open(); //Baglantiyi aç...
            //Yapılacak is...
            SqlCommand sqlCommand = new SqlCommand("SELECT * FROM Categories", conn);

            //Tum tabloyu oku...
            SqlDataReader dr = sqlCommand.ExecuteReader();

            List<Category> categories = new List<Category>();

            //son kayda kadar tum satırları oku...
            while (dr.Read())
            {

                //Tabloda tutulan her satırı Category nesnesine cevir...
                Category category = new Category()
                {
                    CategoryID = Convert.ToInt32(dr[0]),
                    CategoryName = dr.GetString(1),
                    Description = dr.GetString(2)
                };
                //listeye ekle...
                categories.Add(category);

            }
            conn.Close(); //Baglantiyi kapat...

            //verileri listbox icerisinde goster.ççç
            listBox1.DataSource = categories;
        }

        private void btnProducts_Click(object sender, EventArgs e)
        {
            NorthwindContext context = new NorthwindContext();

            // dataGridView1.DataSource = context.Products.ToList();

            context.Categories.Add(new Models.Category { CategoryName = "yepyeni kat.", Description = "iste oyle.." });
            // context.SaveChanges();


            dataGridView1.DataSource = context.Categories.ToList();
        }

        private void button1_Click(object sender, EventArgs e)
        {


            var kat = context.Categories.Find(10);
            context.Categories.Remove(kat);
            context.SaveChanges();
        }
        NorthwindContext context = new NorthwindContext();
        private void button2_Click(object sender, EventArgs e)
        {
            dataGridView1.DataSource = context.Products.Include("Category").Select(x => new { x.ProductId, x.ProductName, x.Category.CategoryName }).ToList();
        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }
    }

//-----------------------------------------------------------------------------------------------------------------------
